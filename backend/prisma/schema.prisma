// https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  userId    String   @id @default(cuid())
  email     String   @unique
  name      String
  createdAt DateTime @default(now())
  items     Item[]
  notifications Notification[]
}

model Item {
  itemId      String     @id @default(cuid())
  title       String
  description String
  status      ItemStatus @default(LOST)
  createdAt   DateTime   @default(now())
  userId      String
  user        User       @relation(fields: [userId], references: [userId], onDelete: Cascade)
  location    String
  archives    Archive[]

  @@index([userId])
  @@index([status])
  @@index([location])
}

model Notification {
  notifId      String @id @default(cuid())
  userId       String 
  relatedUser         User @relation(fields : [userId], references : [userId], onDelete: Cascade)
  message      String
  timestamp    DateTime @default(now()) 
  read         Boolean @default(false)

  @@index([userId])
}

model Archive {
  archiveId    String   @id @default(cuid())
  itemId       String
  item         Item     @relation(fields: [itemId], references: [itemId], onDelete: Cascade)
  resolvedTime DateTime @default(now())
  reason       String? //Optional field

  @@index([itemId])
}

enum ItemStatus {
  LOST
  FOUND
  CLAIMED
}

